Цепь областей видимости (Scope, Scope chain, сокращённо SC) – это связанная с контекстом исполнения цепь объектов переменных, в которой происходит поиск переменных при разрешении имён идентификаторов.

Scope chain функции создаётся при её выполнении, и состоит из объекта активации и внутреннего свойства функции [[Scope]].

                                        activeExecutionContext = {
                                            VO: {...}, // или AO
                                            this: thisValue,
                                            Scope: [ // Scope chain
                                            // список всех объектов переменных
                                            // для поиска идентификаторов
                                            ] 
                                        };

                                        Scope = AO + [[Scope]]

[[Scope]] – это иерархическая цепь объектов переменных (VO), стоящих выше контекста функции; цепь записывается свойством в функцию при её создании.

Ключевой момент – [[Scope]] записывается в функцию при её создании – статически (неизменно), раз, и навсегда (до уничтожения функции). Т.е. функция может быть ни разу не вызвана, но свойство [[Scope]] в неё уже записано.

Ещё один момент, который следует учесть, это то, что [[Scope]], в отличии от Scope (Scope chain), является свойством функции, а не контекста.

                                        var x = 10;
                                        function foo() {
                                            var y = 20;
                                            alert(x + y);
                                        }
                                        foo(); // 30

                                        fooContext.AO = {
                                            y: undefined // undefined - при входе, 20 - при вызове
                                        };

                                        foo.[[Scope]] = [
                                           globalContext.VO // === Global
                                        ];

    ЗАМЫКАНИЯ

Замыкания (Closures) в ECMAScript напрямую связаны со свойством функций [[Scope]]. Как уже было отмечено, [[Scope]] запоминается при создании функции и существует до тех пор, пока жива сама функция. Собственно, замыкание — это и есть комбинация кода функции и её свойства [[Scope]]. При этом, [[Scope]] одним из объектов цепи содержит то лексическое окружение (родительский объект переменных), в котором функция порождается. Переменные из вышестоящих контекстов при дальнейшей активации функции будут искаться именно в этой лексической (статически запомненной при создании) цепи объектов переменных.

                                        var x = 10;
                                        
                                        function foo() {
                                            alert(x);
                                        }
                                        
                                        (function () {
                                            var x = 20;
                                            foo(); // 10, а не 20
                                        })();

Видим, что переменная “x” найдена в [[Scope]] функции “foo”, т.е. для поиска переменных используется лексическая (замкнутая) цепь, определяемая на момент создания функции, но не динамическая цепь вызова, при которой значение переменной “x” определилось бы как 20.

[[Scope]] функций, созданных конструктором Function
являясь исключением, функции, порождённые конструктором Function в качестве [[Scope]] всегда имеют лишь глобальный объект. Т.е. создать замыкание внешних контекстов, кроме глобального, при помощи такой функции уже не получится.